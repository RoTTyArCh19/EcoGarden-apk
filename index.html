<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Descarga Ecogarden</title>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            text-align: center;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .download-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }
        
        .qr-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        #qrcode {
            display: flex;
            justify-content: center;
        }
        
        .btn-download {
            display: inline-block;
            background: #ff4081;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            padding: 15px 40px;
            border-radius: 50px;
            text-decoration: none;
            box-shadow: 0 5px 15px rgba(255, 64, 129, 0.4);
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn-download:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 64, 129, 0.6);
            background: #ff1a66;
        }
        
        .instructions {
            margin-top: 30px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 10px;
            max-width: 500px;
        }
        
        .device-info {
            margin-top: 20px;
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        .github-info {
            margin-top: 40px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 0.9rem;
        }
        
        .app-info {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        
        .debug-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 0.8rem;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            p {
                font-size: 1rem;
            }
            
            .container {
                padding: 25px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="app-info">
            <h1>Ecogarden App</h1>
            <p>Tu app ecol√≥gica favorita ahora en tu m√≥vil</p>
        </div>
        
        <div class="download-section">
            <div id="desktop-view">
                <div class="qr-container">
                    <div id="qrcode"></div>
                </div>
                <p class="instructions">Escanea este c√≥digo QR con tu dispositivo m√≥vil para descargar Ecogarden</p>
            </div>
            
            <div id="mobile-view">
                <a href="#" class="btn-download" id="download-btn" download="ecogarden.apk">Descargar Ecogarden APK</a>
                <p class="instructions">Toca el bot√≥n para descargar e instalar la aplicaci√≥n Ecogarden</p>
            </div>
        </div>
        
        <div class="device-info" id="device-info">
            <!-- Informaci√≥n del dispositivo detectado -->
        </div>
        
        <!-- Debug info ahora S√ç existe en el DOM -->
        <div class="debug-info" id="debug-info"></div>
        
        <div class="github-info">
            <h3>Instrucciones</h3>
            <p>‚Ä¢ En computador: Usa el c√≥digo QR para descargar en tu m√≥vil</p>
            <p>‚Ä¢ En m√≥vil: Toca el bot√≥n de descarga directa</p>
        </div>
    </div>

    <script>
        // El archivo APK debe llamarse "ecogarden.apk" y estar en la misma carpeta
        const apkUrl = "ecogarden.apk";
        const apkFullUrl = "https://rottyarch19.github.io/EcoGarden-apk/ecogarden.apk";
        
        // Elementos del DOM
        const desktopView = document.getElementById('desktop-view');
        const mobileView = document.getElementById('mobile-view');
        const downloadBtn = document.getElementById('download-btn');
        const deviceInfo = document.getElementById('device-info');
        const debugInfo = document.getElementById('debug-info');
        
        // Funci√≥n para detectar si es un dispositivo m√≥vil
        function isMobileDevice() {
            return (typeof window.orientation !== "undefined") || 
                   (navigator.userAgent.indexOf('IEMobile') !== -1) ||
                   (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));
        }
        
        // Funci√≥n para generar el c√≥digo QR con manejo de errores
function generateQRCode() {
    try {
        console.log('Iniciando generaci√≥n de QR...');
        
        const qrContainer = document.getElementById('qrcode');
        if (!qrContainer) {
            throw new Error('No se encontr√≥ el contenedor del QR');
        }

        qrContainer.innerHTML = '';

        if (debugInfo) {
            debugInfo.innerHTML = `üîó URL para descarga: ${apkFullUrl}`;
            debugInfo.style.display = 'block';
        }

        // *** AQU√ç EL CAMBIO IMPORTANTE ***
        qrcode.toCanvas(qrContainer, apkFullUrl, {
            width: 200,
            margin: 2,
            color: {
                dark: '#000000',
                light: '#FFFFFF'
            },
            errorCorrectionLevel: 'H'
        }, function (error) {
            if (error) {
                console.error('Error generando QR:', error);
                qrContainer.innerHTML = `
                    <div style="color: red; padding: 20px;">
                        <p>Error generando c√≥digo QR</p>
                        <p>URL: ${apkFullUrl}</p>
                        <button onclick="regenerateQR()" style="padding: 10px; margin: 10px; background: #ff4081; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            Reintentar
                        </button>
                    </div>
                `;
            } else {
                console.log('‚úÖ QR generado exitosamente');
                if (debugInfo) {
                    debugInfo.innerHTML += '<br>‚úÖ QR generado correctamente';
                }
            }
        });

    } catch (error) {
        console.error('Error en generateQRCode:', error);
        const qrContainer = document.getElementById('qrcode');
        if (qrContainer) {
            qrContainer.innerHTML = `
                <div style="color: red; padding: 20px;">
                    Error: ${error.message}
                    <br>
                    <button onclick="generateQRCode()" style="padding: 10px; margin: 10px; background: #ff4081; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        Reintentar Generaci√≥n QR
                    </button>
                </div>
            `;
        }
    }
}        
        // Funci√≥n para regenerar QR (global para que funcione en el onclick)
        function regenerateQR() {
            console.log('Reintentando generar QR...');
            generateQRCode();
        }
        
        // Configurar la p√°gina seg√∫n el dispositivo
        function setupPage() {
            const isMobile = isMobileDevice();
            
            console.log('Dispositivo detectado:', isMobile ? 'M√≥vil' : 'Computador');
            console.log('User Agent:', navigator.userAgent);
            
            if (isMobile) {
                // Es un dispositivo m√≥vil - mostrar bot√≥n de descarga
                desktopView.style.display = 'none';
                mobileView.style.display = 'block';
                downloadBtn.href = apkUrl;
                deviceInfo.textContent = "üì± Dispositivo m√≥vil detectado - Usa el bot√≥n para descargar Ecogarden";
            } else {
                // Es un computador - mostrar c√≥digo QR
                desktopView.style.display = 'block';
                mobileView.style.display = 'none';
                downloadBtn.href = apkFullUrl;
                deviceInfo.textContent = "üíª Computador detectado - Usa el c√≥digo QR para descargar Ecogarden en tu m√≥vil";
                
                // Generar QR despu√©s de un peque√±o delay para asegurar que el DOM est√© listo
                setTimeout(generateQRCode, 500);
            }
        }
        
        // Inicializar la p√°gina cuando el DOM est√© listo
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM cargado, iniciando configuraci√≥n...');
            setupPage();
        });
        
        // Tambi√©n inicializar cuando la p√°gina termine de cargar
        window.addEventListener('load', function() {
            console.log('P√°gina completamente cargada');
            // Regenerar QR por si acaso
            if (!isMobileDevice()) {
                setTimeout(generateQRCode, 1000);
            }
        });
    </script>
</body>
</html>

